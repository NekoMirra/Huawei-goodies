<Window x:Class="GoodiesControl.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Matebook E Go Goodies" Height="540" Width="720" MinHeight="480" MinWidth="640">
    <Grid Margin="12">
        <Grid.LayoutTransform>
            <!-- 默认 1.5x 缩放以匹配 Windows 缩放习惯 -->
            <ScaleTransform ScaleX="1.5" ScaleY="1.5" />
        </Grid.LayoutTransform>

        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- 键盘拆离 -->
                <Border BorderBrush="#DDD" BorderThickness="1" Padding="12" CornerRadius="6" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock Text="键盘拆离" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <Button x:Name="QueryKeyboardButton" Content="查询状态" Width="90" Margin="0,0,8,0" Click="QueryKeyboardButton_Click"/>
                            <Button x:Name="EnableKeyboardButton" Content="启用" Width="90" Margin="0,0,8,0" Click="EnableKeyboardButton_Click"/>
                            <Button x:Name="DisableKeyboardButton" Content="禁用" Width="90" Click="DisableKeyboardButton_Click"/>
                        </StackPanel>
                        <CheckBox x:Name="TabletGuardToggle" Content="平板模式时自动禁用键盘，恢复时自动启用" IsChecked="True" Margin="0,0,0,6" Checked="TabletGuardToggle_Checked" Unchecked="TabletGuardToggle_Checked"/>
                        <TextBlock x:Name="KeyboardStatusText" Text="状态未知" Margin="0,0,0,4"/>
                        <TextBlock Text="内部调用 kbd-detach，需随附 KeyboardService.dll" FontSize="12" Foreground="Gray"/>
                    </StackPanel>
                </Border>

                <!-- 屏幕校色 (QDCM) -->
                <Border BorderBrush="#DDD" BorderThickness="1" Padding="12" CornerRadius="6" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock Text="屏幕校色 (QDCM)" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,8"/>
                        <WrapPanel ItemWidth="120" ItemHeight="36" MinHeight="36" HorizontalAlignment="Left" Orientation="Horizontal" Margin="0,0,0,8">
                            <Button x:Name="ApplyP3Button" Content="Display P3" Width="120" Margin="0,0,8,8" Click="ApplyP3Button_Click"/>
                            <Button x:Name="ApplySrgbButton" Content="sRGB" Width="120" Margin="0,0,8,8" Click="ApplySrgbButton_Click"/>
                            <Button x:Name="ResetDisplayButton" Content="重置" Width="120" Margin="0,0,8,8" Click="ResetDisplayButton_Click"/>
                        </WrapPanel>

                        <GroupBox Header="自定义 LUT" Padding="8">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                    <TextBlock Text="IGC (3x1D)" Width="80" VerticalAlignment="Center"/>
                                    <TextBox x:Name="IgcPathBox" Width="360" Margin="6,0,0,0"/>
                                    <Button Content="浏览" Width="70" Margin="6,0,0,0" Click="BrowseIgcButton_Click"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                    <TextBlock Text="3D LUT" Width="80" VerticalAlignment="Center"/>
                                    <TextBox x:Name="Lut3DPathBox" Width="360" Margin="6,0,0,0"/>
                                    <Button Content="浏览" Width="70" Margin="6,0,0,0" Click="BrowseLutButton_Click"/>
                                </StackPanel>
                                <Button x:Name="ApplyCustomLutButton" Content="应用自定义 LUT" Width="170" HorizontalAlignment="Left" Click="ApplyCustomLutButton_Click"/>
                            </StackPanel>
                        </GroupBox>
                        <TextBlock x:Name="QdcmStatusText" Text="等待操作" Margin="0,8,0,4"/>
                        <TextBlock Text="需要 qdcm-loader 及 qdcmlib.dll 对应架构" FontSize="12" Foreground="Gray"/>
                    </StackPanel>
                </Border>

                <!-- 电池充电限制 -->
                <Border BorderBrush="#DDD" BorderThickness="1" Padding="12" CornerRadius="6" Margin="0,0,0,0">
                    <StackPanel>
                        <TextBlock Text="电池充电限制" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Slider x:Name="ChargeSlider" Minimum="50" Maximum="100" Value="80" Width="240" TickFrequency="5" IsSnapToTickEnabled="True" Margin="0,0,8,0"/>
                            <TextBlock x:Name="ChargeValueText" Text="80%" Width="60" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <Button x:Name="ApplyChargeButton" Content="应用" Width="90" Click="ApplyChargeButton_Click"/>
                        </StackPanel>
                        <TextBlock Text="【如提示拒绝访问请使用管理员身份运行】内部调用 WMI OemWMIfun，与 Set-ChargeLimit.ps1 逻辑一致" FontSize="12" Foreground="Gray" Margin="0,8,0,4"/>
                        <TextBlock x:Name="ChargeStatusText" Text="尚未设置"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
